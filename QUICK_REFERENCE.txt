================================================================================
PROJECT FRIDAY - QUICK REFERENCE GUIDE
================================================================================

PROJECT BASICS:
- Name: Project Friday - AI Workspace Orchestrator
- Language: Python 3.8+
- Total Size: 2.2 MB | 52 Python files | ~27,000 lines of code
- Status: Active development (claude/code-review-refactor branch)

================================================================================
CORE ARCHITECTURE
================================================================================

Pattern: Hub-and-Spoke Multi-Agent System

OrchestratorAgent (central hub)
  ├── Slack Agent (Slack integration - 1763 LOC)
  ├── Jira Agent (Issue tracking - 1708 LOC)
  ├── GitHub Agent (GitHub integration - 1673 LOC)
  ├── Notion Agent (Notion integration - 1570 LOC)
  ├── Google Calendar Agent (Calendar - 1463 LOC)
  ├── Code Reviewer Agent (Code review - 716 LOC)
  ├── Browser Agent (Web automation - 791 LOC)
  └── Scraper Agent (Web scraping - 809 LOC)

Key Features:
  - Hybrid Intelligence System v5.0 (Fast Filter + LLM)
  - Circuit Breaker Pattern (prevents cascading failures)
  - Smart Retry Management (exponential backoff)
  - Undo System (reversible operations)
  - User Preference Learning
  - Comprehensive Analytics & Observability

================================================================================
TECHNOLOGY STACK
================================================================================

Core Technologies:
  - Language: Python 3.8+
  - Async Runtime: asyncio
  - LLM Provider: Google Gemini Flash
  - Agent Protocol: Model Context Protocol (MCP)
  - Terminal UI: Rich library
  - Config: python-dotenv
  - Data Persistence: JSON files (no database)

Key Dependencies:
  - google-generativeai (Gemini API)
  - python-dotenv (config management)
  - rich (terminal UI)
  - mcp (agent communication)

================================================================================
DIRECTORY STRUCTURE
================================================================================

/core/                  (17 files, ~7K LOC)
  - Logging system (logging_config, simple_session_logger, intelligence_logger)
  - Error handling (error_handler, error_messaging, input_validator)
  - Advanced features (analytics, retry_manager, circuit_breaker, undo_manager)
  - Observability (observability, distributed_tracing, metrics_aggregator)

/connectors/            (12 files, ~12K LOC)
  - base_agent.py (BaseAgent abstract class)
  - agent_intelligence.py (ConversationMemory, WorkspaceKnowledge)
  - 8 specialized agents (Slack, Jira, GitHub, Notion, Calendar, etc.)
  - mcp_config.py (MCP timeouts and retry configuration)

/intelligence/          (12 files, ~6.5K LOC)
  - base_types.py (Intent, Entity, Task, Confidence types)
  - hybrid_system.py (Two-tier intelligence: Fast Filter + LLM)
  - intent_classifier.py, entity_extractor.py, task_decomposer.py
  - confidence_scorer.py, context_manager.py
  - cache_layer.py, fast_filter.py, llm_classifier.py

/llms/                  (2 files)
  - base_llm.py (Abstract LLM interface)
  - gemini_flash.py (Gemini implementation)

/ui/                    (2 files)
  - enhanced_terminal_ui.py (Rich-based beautiful UI)
  - terminal_ui.py (Simple fallback UI)

/tools/                 (1 file)
  - session_viewer.py (Session log analysis tool)

/scripts/               (1 file)
  - migrate_logging.py (Logging migration utility)

/docs/                  (5 markdown files)
  - Documentation on logging system, session viewer, orchestrator integration

================================================================================
ENTRY POINTS
================================================================================

Primary Entry Point:
  python main.py              # Standard mode
  python main.py --verbose    # Debug mode
  python main.py --simple     # Use simple UI

Secondary Entry Points:
  python tools/session_viewer.py <session_id>

Entry Point Code:
  - main.py: OrchestratorAgent initialization and async loop
  - orchestrator.py: process_message() → main processing pipeline

================================================================================
CONFIGURATION
================================================================================

Configuration File: .env.example (140+ options)

Sections:
  1. API Keys (GOOGLE_API_KEY, NOTION_TOKEN, etc.)
  2. Confirmation Settings (CONFIRM_SLACK_MESSAGES, CONFIRM_JIRA_OPERATIONS)
  3. Agent Operation Settings (Timeouts)
  4. Batch Processing (Batch size, timeout)
  5. Retry Configuration (Max retries, backoff)
  6. Logging Configuration (Log level, format)
  7. Per-Module Log Levels
  8. Security Settings (Sanitization, input limits)
  9. Enrichment Settings

Config Class: config.py
  - Centralized configuration management
  - Environment variable overrides
  - Default values built in

================================================================================
KEY ARCHITECTURAL PATTERNS
================================================================================

1. Multi-Agent Orchestration
   - Central orchestrator coordinates specialized agents
   - Dynamic agent discovery from connectors/ directory
   - Async execution for concurrent operations

2. Hybrid Intelligence System v5.0
   - Two-tier decision making
   - Tier 1: FastKeywordFilter (~10ms, free, 35-40% coverage)
   - Tier 2: LLMIntentClassifier (~200ms, paid, 60-65% coverage)

3. Abstract Base Classes
   - BaseAgent: All agents inherit
   - BaseLLM: All LLM providers implement
   - Enforces consistent interface

4. Error Handling & Recovery
   - ErrorClassifier: Categorize errors
   - RetryManager: Smart retries with backoff
   - CircuitBreaker: Prevent cascading failures

5. Observability & Monitoring
   - SimpleSessionLogger: JSONL-based logging
   - DistributedTracing: OpenTelemetry-compatible
   - AnalyticsCollector: Metrics tracking

6. Undo System
   - UndoManager: Reversible operations
   - Custom handlers per operation type

7. Adaptive Learning
   - UserPreferenceManager: Learn user preferences
   - Persistent storage in JSON

8. Provider-Agnostic Design
   - Can swap LLM providers
   - MCP protocol for agent communication

================================================================================
DATA FLOW
================================================================================

Typical User Message Processing:

1. User Input
   ↓
2. Input Validation (InputValidator)
   ↓
3. Hybrid Intelligence Processing
   ├─ Fast Filter (try first)
   └─ LLM Classifier (if needed)
   ↓
4. Intent/Entity/Task Analysis
   ├─ IntentClassifier
   ├─ EntityExtractor
   └─ TaskDecomposer
   ↓
5. Agent Selection & Routing
   ↓
6. Agent Execution (with retry/circuit breaker)
   ├─ RetryManager
   └─ CircuitBreaker
   ↓
7. Response Formatting & Logging
   ↓
8. User Output (Enhanced Terminal UI)

================================================================================
TESTING STRUCTURE
================================================================================

Status: NO AUTOMATED TESTS
  - No test directory
  - No pytest.ini or test files
  - Manual testing via session logs
  - Session logs stored in logs/ directory as JSONL

Session Log Files (per session):
  1. session_{id}_messages.jsonl (Message flow)
  2. session_{id}_intelligence.jsonl (Intelligence metrics)

Session Viewer Tool:
  python tools/session_viewer.py <session_id>

================================================================================
IMPORTANT FILES & CLASSES
================================================================================

Main Orchestrator:
  - orchestrator.py: OrchestratorAgent (1806 LOC)

Key Classes:
  - BaseAgent (base_agent.py): Abstract agent interface
  - BaseLLM (base_llm.py): Abstract LLM interface
  - HybridIntelligenceSystem (hybrid_system.py): Two-tier intelligence
  - ErrorClassifier (error_handler.py): Error categorization
  - RetryManager (retry_manager.py): Retry logic
  - CircuitBreaker (circuit_breaker.py): Failure prevention
  - UndoManager (undo_manager.py): Undo support
  - UserPreferenceManager (user_preferences.py): Preference learning
  - AnalyticsCollector (analytics.py): Metrics tracking

Key Data Types:
  - Intent, Entity, Task, ExecutionPlan (intelligence/base_types.py)
  - LLMResponse, FunctionCall (llms/base_llm.py)
  - ErrorClassification (core/error_handler.py)

================================================================================
COMMAND SUMMARY
================================================================================

List all Python files by size:
  wc -l /home/user/Project-Friday/**/*.py

View orchestrator class methods:
  grep -n "def " /home/user/Project-Friday/orchestrator.py

List all agent classes:
  grep "^class Agent" /home/user/Project-Friday/connectors/*.py

Check configuration options:
  head -100 /home/user/Project-Friday/.env.example

View documentation:
  ls /home/user/Project-Friday/docs/

Analyze a session:
  python /home/user/Project-Friday/tools/session_viewer.py <session_id>

================================================================================
COMPLETE ANALYSIS DOCUMENT
================================================================================

A comprehensive analysis document has been created:
  /home/user/Project-Friday/CODEBASE_ANALYSIS.md (902 lines)

This document includes:
  - Complete architecture overview
  - All directory details with line counts
  - Technology stack and dependencies
  - Entry points and configuration
  - Key patterns and conventions
  - Data flow diagrams
  - Complete directory tree
  - Session and logging structure

================================================================================
